<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>EDS 217: Python for Environmental Data Science - jupyter setup for EDS 217</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles/activities.css">
</head>

<body class="floating">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#jupyter-notebooks" id="toc-jupyter-notebooks" class="nav-link active" data-scroll-target="#jupyter-notebooks">Jupyter Notebooks</a></li>
  <li><a href="#launching-the-jupyter-notebook-server" id="toc-launching-the-jupyter-notebook-server" class="nav-link" data-scroll-target="#launching-the-jupyter-notebook-server">Launching the Jupyter Notebook Server</a>
  <ul class="collapse">
  <li><a href="#open-a-terminal" id="toc-open-a-terminal" class="nav-link" data-scroll-target="#open-a-terminal">Open a terminal</a></li>
  <li><a href="#activate-the-eds217_2023-environment" id="toc-activate-the-eds217_2023-environment" class="nav-link" data-scroll-target="#activate-the-eds217_2023-environment">Activate the <code>EDS217_2023</code> environment</a></li>
  <li><a href="#change-directory-to-the-root-of-the-class-repository" id="toc-change-directory-to-the-root-of-the-class-repository" class="nav-link" data-scroll-target="#change-directory-to-the-root-of-the-class-repository">Change directory to the root of the class repository</a></li>
  <li><a href="#launch-the-server" id="toc-launch-the-server" class="nav-link" data-scroll-target="#launch-the-server">Launch the server</a></li>
  </ul></li>
  <li><a href="#basic-jupyter-notebook-usage" id="toc-basic-jupyter-notebook-usage" class="nav-link" data-scroll-target="#basic-jupyter-notebook-usage">Basic Jupyter Notebook Usage</a>
  <ul class="collapse">
  <li><a href="#creating-a-new-notebook" id="toc-creating-a-new-notebook" class="nav-link" data-scroll-target="#creating-a-new-notebook">Creating a new notebook</a></li>
  <li><a href="#selecting-a-kernel" id="toc-selecting-a-kernel" class="nav-link" data-scroll-target="#selecting-a-kernel">Selecting a kernel</a></li>
  <li><a href="#the-notebook-interface" id="toc-the-notebook-interface" class="nav-link" data-scroll-target="#the-notebook-interface">The notebook interface</a>
  <ul class="collapse">
  <li><a href="#the-title-bar" id="toc-the-title-bar" class="nav-link" data-scroll-target="#the-title-bar">The title bar</a></li>
  <li><a href="#the-toolbar" id="toc-the-toolbar" class="nav-link" data-scroll-target="#the-toolbar">The toolbar</a></li>
  </ul></li>
  <li><a href="#saving-a-notebook" id="toc-saving-a-notebook" class="nav-link" data-scroll-target="#saving-a-notebook">Saving a notebook</a></li>
  <li><a href="#working-with-cells" id="toc-working-with-cells" class="nav-link" data-scroll-target="#working-with-cells">Working with cells</a></li>
  <li><a href="#running-a-cell" id="toc-running-a-cell" class="nav-link" data-scroll-target="#running-a-cell">Running a cell</a></li>
  <li><a href="#adding-a-cell-to-a-notebook" id="toc-adding-a-cell-to-a-notebook" class="nav-link" data-scroll-target="#adding-a-cell-to-a-notebook">Adding a cell to a notebook</a></li>
  <li><a href="#deleting-a-cell" id="toc-deleting-a-cell" class="nav-link" data-scroll-target="#deleting-a-cell">Deleting a cell</a></li>
  </ul></li>
  <li><a href="#testing-our-environment" id="toc-testing-our-environment" class="nav-link" data-scroll-target="#testing-our-environment">Testing our Environment</a></li>
  <li><a href="#congratulations" id="toc-congratulations" class="nav-link" data-scroll-target="#congratulations">Congratulations!?</a>
  <ul class="collapse">
  <li><a href="#youve-successfully-run-your-first-jupyter-notebook" id="toc-youve-successfully-run-your-first-jupyter-notebook" class="nav-link" data-scroll-target="#youve-successfully-run-your-first-jupyter-notebook">You’ve successfully run your first jupyter notebook!</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<hr>
<h4 class="anchored"> <a href="../">Return to Course Home Page</a></h4>
<hr>

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">jupyter setup for EDS 217</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="jupyter-notebooks" class="level1">
<h1>Jupyter Notebooks</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/example-notebook.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">example notebook</figcaption>
</figure>
</div>
<p>Jupyter notebooks are a very common approach for working in python data science. They have many of the same advantages as <code>Rmd</code> files, and can be exported into <code>.pdf</code>, <code>.html</code>, and even into pure python files (<code>.py</code>). While most IDEs can work with notebook files, the jupyter notebook server will always have the greatest amount of functionality and access to extensions that enhance the notebook experience (e.g.&nbsp;the <a href="https://rise.readthedocs.io"><code>RISE</code></a> extension, which powers this class’s lecture slideshows)</p>
</section>
<section id="launching-the-jupyter-notebook-server" class="level1">
<h1>Launching the Jupyter Notebook Server</h1>
<p>You can launch a server locally very easily at the command line:</p>
<section id="open-a-terminal" class="level2">
<h2 class="anchored" data-anchor-id="open-a-terminal">Open a terminal</h2>
<p><strong>Windows</strong>: Open PowerShell or Command Prompt</p>
<p><strong>Mac/Linux</strong>: Open Terminal</p>
</section>
<section id="activate-the-eds217_2023-environment" class="level2">
<h2 class="anchored" data-anchor-id="activate-the-eds217_2023-environment">Activate the <code>EDS217_2023</code> environment</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate eds217_2023</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="change-directory-to-the-root-of-the-class-repository" class="level2">
<h2 class="anchored" data-anchor-id="change-directory-to-the-root-of-the-class-repository">Change directory to the root of the class repository</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> path/to/eds217_2023</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note: Your path will be different depending on where you cloned your repo in the previous step.</p>
<p>You can find the path by right-clicking on the folder in the file explorer and selecting “Properties” (Windows) or “Get Info” (Mac).</p>
</section>
<section id="launch-the-server" class="level2">
<h2 class="anchored" data-anchor-id="launch-the-server">Launch the server</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">jupyter</span> notebook</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A browser window should open automatically. If it doesn’t, you can copy the URL from the terminal and paste it into your browser.</p>
</section>
</section>
<section id="basic-jupyter-notebook-usage" class="level1">
<h1>Basic Jupyter Notebook Usage</h1>
<p>Your browser window should look something like this:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/notebook_launch.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">notebook launch</figcaption>
</figure>
</div>
<p>Let’s start by adding a new folder to the file browser. Click the “New” button in the upper right corner of the file browser, and select “Folder”.</p>
<p>Name the folder <code>nbs</code>. This is where you will store all of your notebooks for this class.</p>
<p>Once you’ve created the folder, click on it to enter it. You should see a blank file browser.</p>
<section id="creating-a-new-notebook" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-new-notebook">Creating a new notebook</h2>
<p>You can create a new notebook by clicking the “New” button in the upper right corner of the file browser and selecting “notebook”. This will create a new notebook in the current directory. The default name is <code>Untitled.ipynb</code>. We can change that later, so for now, just open the file by clicking on it.</p>
</section>
<section id="selecting-a-kernel" class="level2">
<h2 class="anchored" data-anchor-id="selecting-a-kernel">Selecting a kernel</h2>
<p>A kernel is the “computational engine” that runs your notebook. It is the thing that actually executes the code you write. When you open a new notebook, you will be prompted to select a kernel. Select the <code>eds217_2023</code> kernel. You can set our class environment as the default kernel by clicking the “Always start the preferred kernel” button.</p>
</section>
<section id="the-notebook-interface" class="level2">
<h2 class="anchored" data-anchor-id="the-notebook-interface">The notebook interface</h2>
<p>If everything has gone to plan, you should now be seeing a browser window that looks a lot like this:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/notebook_interface.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">notebook interface</figcaption>
</figure>
</div>
<p>Let’s take a quick tour of the interface together.</p>
<section id="the-title-bar" class="level3">
<h3 class="anchored" data-anchor-id="the-title-bar">The title bar</h3>
<p>The title bar is the row of text at the top of the notebook. It contains the name of the notebook as well as the time since the last save (or “Checkpoint”). You can change the name of the notebook by clicking on the name and typing a new one.</p>
<p><strong>Change the title of your notebook to <code>test_environment</code></strong></p>
</section>
<section id="the-toolbar" class="level3">
<h3 class="anchored" data-anchor-id="the-toolbar">The toolbar</h3>
<p>The toolbar is the row of buttons at the top of the notebook. It contains buttons for saving the notebook, adding cells, running cells, and more. We’ll go over these in more detail later. For now, the important point to notice is the text at the far right of the toolbar. It should say <code>eds217_2023</code>. This is the name of the kernel that is running your notebook. If you click on it, you can change the kernel (but don’t do that now!)</p>
</section>
</section>
<section id="saving-a-notebook" class="level2">
<h2 class="anchored" data-anchor-id="saving-a-notebook">Saving a notebook</h2>
<p>You save a notebook by clicking the “Save” button in the upper left corner of the toolbar (it looks like a floppy disk). Do this now. You will see the “Last Checkpoint” update:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/last_checkpoint.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">last checkpoint</figcaption>
</figure>
</div>
</section>
<section id="working-with-cells" class="level2">
<h2 class="anchored" data-anchor-id="working-with-cells">Working with cells</h2>
<p>There are two cell types in a jupyter notebook: code cells and markdown cells. Code cells are for writing code, and markdown cells are for writing text. You can change the type of a cell by clicking on the dropdown menu in the toolbar and selecting the type you want.</p>
<p>The notebook has been initialized with a single cell. You can tell it’s a code cell because it has <code>[ ]:</code> to the left of it. We want a markdown cell instead, so we can add a title to this notebook and describe what it’s for.</p>
<p><strong>Change the cell type to markdown by clicking the dropdown menu in the toolbar and selecting “Markdown”</strong></p>
<p>You can now type text into the cell. Try typing a title for the notebook and a short description of what it’s for. You can use markdown syntax to format the text. If you need a refresher on markdown syntax, you can find one <a href="https://www.markdownguide.org/basic-syntax/">here</a>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/markdown_cell.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">markdown cell</figcaption>
</figure>
</div>
</section>
<section id="running-a-cell" class="level2">
<h2 class="anchored" data-anchor-id="running-a-cell">Running a cell</h2>
<p>Once you’ve written your text, you can render it by running the cell. You can do this by clicking the “Run” button in the toolbar, or by pressing <code>Shift+Enter</code>. Do this now.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/rendered_markdown_cell.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">rendered markdown cell</figcaption>
</figure>
</div>
<p>Note: You can always edit the cell again by double-clicking on it. Re-rendering the cell by running it again will update the cell output.</p>
</section>
<section id="adding-a-cell-to-a-notebook" class="level2">
<h2 class="anchored" data-anchor-id="adding-a-cell-to-a-notebook">Adding a cell to a notebook</h2>
<p>You can add a cell to a notebook by clicking the “+” button in the toolbar. This will add a cell below the currently selected cell.</p>
<p>You can also add a cell above +[] or below []+ the currently selected cell by clicking the buttons in the cell’s toolbar on the far right. These buttons have keyboard shortcuts (<code>A</code>) and (‘B’).</p>
<p><strong>Press <code>B</code> to add a cell below the currently selected cell</strong></p>
<p>The default new cell type is code.</p>
</section>
<section id="deleting-a-cell" class="level2">
<h2 class="anchored" data-anchor-id="deleting-a-cell">Deleting a cell</h2>
<p>You can delete a cell by clicking the scissors button in the toolbar. This will delete the currently selected cell. There is also a trashcan icon in the cell toolbar that will delete the cell. Finally, you can also use the keyboard shortcut <code>D,D</code> (press <code>D</code> twice).</p>
<p><strong>Practice adding, deleting, and changing the type of cells until you are comfortable with the process</strong></p>
</section>
</section>
<section id="testing-our-environment" class="level1">
<h1>Testing our Environment</h1>
<p>We are going to add code to the notebook to test that our environment is working correctly.</p>
<p>Here is the code we need to add:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"You're all set!</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> warnings</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    warnings.filterwarnings(</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        action<span class="op">=</span><span class="st">'ignore'</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        category<span class="op">=</span><span class="pp">UserWarning</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        module<span class="op">=</span><span class="st">'_distutils_hack'</span>)        </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    pd.show_versions()</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span>:</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Uh-oh!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Add this code to a new cell in your notebook and run it</strong></p>
</section>
<section id="congratulations" class="level1">
<h1>Congratulations!?</h1>
<p>Hopefully you now see something like this:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/successful_environment_test.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">successful environment test</figcaption>
</figure>
</div>
<section id="youve-successfully-run-your-first-jupyter-notebook" class="level3">
<h3 class="anchored" data-anchor-id="youve-successfully-run-your-first-jupyter-notebook">You’ve successfully run your first jupyter notebook!</h3>
<p>If you see the message <code>You're all set!</code> then you’re ready to go. If you see <code>Uh-oh!</code> then something went wrong and you should ask for help.</p>
<p>Assuming you’re all set, you can now save your notebook and close it. You can stop the serverby clicking the “Shut Down” button in the file menu. You can also shut down the notebook server by closing the terminal window where you launched it. Be sure to close the browser window as well.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>